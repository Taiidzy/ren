# üïäÔ∏è Ren - –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä —Å E2EE —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º

<div align="center">

![Ren Logo](https://img.shields.io/badge/Ren-Messenger-blue?style=for-the-badge&logo=messaging)
![License](https://img.shields.io/badge/license-Apache%202.0-green?style=for-the-badge)
![Rust](https://img.shields.io/badge/rust-1.75+-orange?style=for-the-badge&logo=rust)
![Flutter](https://img.shields.io/badge/flutter-3.8+-blue?style=for-the-badge&logo=flutter)
![React](https://img.shields.io/badge/react-19+-cyan?style=for-the-badge&logo=react)

**–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä —Å —Å–∫–≤–æ–∑–Ω—ã–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º (End-to-End Encryption)**

[üöÄ –ù–∞—á–∞—Ç—å](#-–±—ã—Å—Ç—Ä—ã–π-–∑–∞–ø—É—Å–∫) ‚Ä¢ [üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è) ‚Ä¢ [üîß API](#-api-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è) ‚Ä¢ [üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

</div>

---

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ**
- **–°–∫–≤–æ–∑–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (E2EE)** - –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —à–∏—Ñ—Ä—É—é—Ç—Å—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è
- **–ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è** - X25519 Elliptic Curve Diffie-Hellman –¥–ª—è –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏
- **–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω–≤–µ—Ä—Ç–æ–≤** - –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —à–∏—Ñ—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º –∫–ª—é—á–æ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—è
- **ChaCha20-Poly1305 AEAD** –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Ñ–∞–π–ª–æ–≤
- **Argon2id** –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- **PBKDF2-HMAC-SHA256** –¥–ª—è –¥–µ—Ä–∏–≤–∞—Ü–∏–∏ –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–∞ –∏–∑ –ø–∞—Ä–æ–ª—è (100,000 –∏—Ç–µ—Ä–∞—Ü–∏–π)
- **–î–≤–æ–π–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π**:
  - `pkebymk` - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–æ–º –∏–∑ –ø–∞—Ä–æ–ª—è
  - `pkebyrk` - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á–æ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (–¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞)
- **HKDF-SHA256** –¥–ª—è –¥–µ—Ä–∏–≤–∞—Ü–∏–∏ –∫–ª—é—á–µ–π –æ–±—ë—Ä—Ç–∫–∏ –∏–∑ ECDH shared secret
- **Zero-Knowledge –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —Å–µ—Ä–≤–µ—Ä –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏—è–º

### üåê **–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å**
- **Flutter** - –º–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (iOS & Android) —Å –Ω–∞—Ç–∏–≤–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Rust SDK —á–µ—Ä–µ–∑ FFI
- **React + TypeScript** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å WASM –º–æ–¥—É–ª–µ–º
- **iOS Native** - –Ω–∞—Ç–∏–≤–Ω–æ–µ SwiftUI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
- **Rust SDK** - –µ–¥–∏–Ω–æ–µ —è–¥—Ä–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
- **WASM** –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞

### üí¨ **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**
- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∏ –≥—Ä—É–ø–ø–æ–≤—ã–µ —á–∞—Ç—ã** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —á–∞—Ç–æ–≤ –ø–æ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–º –ø–∞—Ä–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–û–±–º–µ–Ω —Ñ–∞–π–ª–∞–º–∏ —Å E2EE —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º** - –¥–æ 50MB, –ø–æ—Ç–æ–∫–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ chunked —Ñ–∞–π–ª–æ–≤
- **–û–±–º–µ–Ω –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ –º–µ–¥–∏–∞-–∫–æ–Ω—Ç–µ–Ω—Ç–æ–º** - —Å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞** - real-time typing indicators —á–µ—Ä–µ–∑ WebSocket
- **–û–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - presence —Å–∏—Å—Ç–µ–º–∞ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –Ω–∞ –∫–æ–Ω—Ç–∞–∫—Ç—ã
- **WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞–º–∏** - –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π** - —Å –æ—Ç–º–µ—Ç–∫–æ–π –≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ü–µ—Ä–µ—Å—ã–ª–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π** - –º–µ–∂–¥—É –ª—é–±—ã–º–∏ —á–∞—Ç–∞–º–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- **–û—Ç–≤–µ—Ç—ã –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è** - reply-to —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- **–ò–∑–±—Ä–∞–Ω–Ω—ã–µ —á–∞—Ç—ã** - —Å–∏—Å—Ç–µ–º–∞ –∑–∞–∫–ª–∞–¥–æ–∫ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- **–õ–æ–∫–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- **–¢–µ–º–Ω–∞—è –∏ —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º—ã** - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Ü–≤–µ—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤** - ETag –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–¥–∏–∞

### ‚ö° **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- **Axum 0.7** - –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–∞ Rust
- **PostgreSQL** - –Ω–∞–¥—ë–∂–Ω–∞—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Tokio** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π runtime –¥–ª—è Rust
- **DashMap** - –±—ã—Å—Ç—Ä—ã–µ concurrent —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è WebSocket —Ö–∞–±–∞
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Rust SDK** —Å LTO (Link Time Optimization)
- **SQLx** - —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Ren/
‚îú‚îÄ‚îÄ Ren-SDK/          # ü¶Ä Rust —è–¥—Ä–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (FFI + WASM)
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crypto.rs      # –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ffi.rs         # C ABI –±–∏–Ω–¥–∏–Ω–≥–∏ (iOS, Android, Flutter)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ wasm.rs        # WebAssembly –±–∏–Ω–¥–∏–Ω–≥–∏ (React)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lib.rs         # –ì–ª–∞–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ Cargo.toml
‚îÇ
‚îú‚îÄ‚îÄ backend/          # üöÄ Axum —Å–µ—Ä–≤–µ—Ä + PostgreSQL
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.rs        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ route/         # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.rs    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –≤—Ö–æ–¥
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.rs   # –ü—Ä–æ—Ñ–∏–ª—å, –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ chats.rs   # –ß–∞—Ç—ã –∏ —Å–æ–æ–±—â–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ media.rs   # –ó–∞–≥—Ä—É–∑–∫–∞/—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ws.rs      # WebSocket –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/        # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ middleware/  # JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ migrations/        # SQL –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ Cargo.toml
‚îÇ
‚îú‚îÄ‚îÄ frontend/         # üåê React –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Pages/         # –°—Ç—Ä–∞–Ω–∏—Ü—ã (Login, Register, Home)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/   # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (Radix UI)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/      # API –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ context/       # React Context –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lib/           # WASM SDK –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ vite.config.ts
‚îÇ
‚îî‚îÄ‚îÄ apps/
    ‚îú‚îÄ‚îÄ flutter/      # üì± Flutter –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    ‚îÇ   ‚îú‚îÄ‚îÄ lib/
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ features/      # –ú–æ–¥—É–ª–∏ (auth, chats, profile)
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/          # SDK –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, WebSocket –∫–ª–∏–µ–Ω—Ç
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.dart
    ‚îÇ   ‚îî‚îÄ‚îÄ pubspec.yaml
    ‚îî‚îÄ‚îÄ ios/          # üçé iOS –Ω–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (SwiftUI)
        ‚îú‚îÄ‚îÄ Ren/
        ‚îÇ   ‚îî‚îÄ‚îÄ RenApp.swift
        ‚îî‚îÄ‚îÄ Ren.xcodeproj
```

### üì¶ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –í–µ—Ä—Å–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|------------|--------|----------|
| **SDK** | Rust | 2021 edition | –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–µ —è–¥—Ä–æ E2EE |
| **–ë—ç–∫–µ–Ω–¥** | Axum | 0.7 | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π HTTP/WebSocket —Å–µ—Ä–≤–µ—Ä |
| **–ë—ç–∫–µ–Ω–¥** | Tokio | 1.x | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π runtime |
| **–ë–î** | PostgreSQL | 14+ | –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| **–ë–î –º–∏–≥—Ä–∞—Ü–∏–∏** | SQLx | 0.7 | –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ |
| **–ú–æ–±–∏–ª—å–Ω—ã–µ** | Flutter | 3.8+ | iOS & Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| **–í–µ–±** | React | 19+ | UI –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ |
| **–í–µ–±** | TypeScript | 5.9+ | –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JavaScript |
| **–í–µ–±** | Vite | 7.2+ | –°–±–æ—Ä—â–∏–∫ –∏ dev-—Å–µ—Ä–≤–µ—Ä |
| **–í–µ–±** | Tailwind CSS | 4.1+ | Utility-first CSS |
| **–í–µ–± UI** | Radix UI | Latest | –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã |
| **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** | X25519-dalek | 2.0 | ECDH –¥–ª—è –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏ |
| **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** | ChaCha20-Poly1305 | 0.10 | AEAD —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ |
| **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** | Argon2 | 0.5 | –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π |
| **JWT** | jsonwebtoken | 9.x | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Rust** 1.75+ ([—É—Å—Ç–∞–Ω–æ–≤–∫–∞](https://rustup.rs/))
- **Flutter** 3.8+ ([—É—Å—Ç–∞–Ω–æ–≤–∫–∞](https://flutter.dev/docs/get-started/install))
- **Node.js** 18+ ([—É—Å—Ç–∞–Ω–æ–≤–∫–∞](https://nodejs.org/))
- **PostgreSQL** 14+ ([—É—Å—Ç–∞–Ω–æ–≤–∫–∞](https://www.postgresql.org/download/))
- **Cargo** (–≤—Ö–æ–¥–∏—Ç –≤ Rust)

### üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

#### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/taiidzy/ren.git
cd ren
```

#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL:

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL
psql -U postgres

# –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
CREATE DATABASE ren_messenger;

# –í—ã–π–¥–∏—Ç–µ –∏–∑ psql
\q
```

#### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—ç–∫–µ–Ω–¥–∞

```bash
cd backend

# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env
cat > .env << EOF
DATABASE_URL=postgres://postgres:password@localhost:5432/ren_messenger
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
EOF

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
cargo run
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:8081`

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
- `DATABASE_URL` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  - –§–æ—Ä–º–∞—Ç: `postgres://USER:PASSWORD@HOST:PORT/DB_NAME`
  - –ü—Ä–∏–º–µ—Ä: `postgres://postgres:password@localhost:5432/ren_messenger`
- `JWT_SECRET` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ JWT —Ç–æ–∫–µ–Ω–æ–≤ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: –º–∏–Ω–∏–º—É–º 32 –±–∞–π—Ç–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è: `openssl rand -base64 32`

#### 4. –°–±–æ—Ä–∫–∞ SDK (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

SDK —É–∂–µ —Å–æ–±—Ä–∞–Ω –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º, –Ω–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å:

```bash
cd Ren-SDK

# –î–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
chmod +x build.sh
./build.sh all

# –ò–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
./build.sh ios      # iOS (XCFramework –¥–ª—è iOS/macOS)
./build.sh android  # Android (JNI –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä)
./build.sh wasm     # WebAssembly (–¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞)
./build.sh linux    # Linux (.so –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
./build.sh windows  # Windows (.dll –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
./build.sh macos    # macOS (.dylib –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —Å–±–æ—Ä–∫–∏:**
- **iOS**: Xcode Command Line Tools, `lipo` –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫
- **Android**: Android NDK, `cargo-ndk` (`cargo install cargo-ndk`)
- **WASM**: `wasm-pack` (`cargo install wasm-pack`)
- **Linux/Windows/macOS**: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã Rust

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–±–æ—Ä–∫–∏:**
- iOS: `target/RenSDK.xcframework` (–¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ Xcode)
- Android: `target/android/jniLibs/` (arm64-v8a, armeabi-v7a, x86, x86_64)
- WASM: `target/pkg/` (web, bundler, node –≤–∞—Ä–∏–∞–Ω—Ç—ã)
- Linux: `target/linux/libren_sdk.so`
- Windows: `target/windows/ren_sdk.dll`
- macOS: `target/macos/libren_sdk.dylib`

#### 5. –ó–∞–ø—É—Å–∫ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
cd apps/flutter

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
flutter pub get

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞ —ç–º—É–ª—è—Ç–æ—Ä–µ/—É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
flutter run

# –ò–ª–∏ —Å–æ–±–µ—Ä–∏—Ç–µ —Ä–µ–ª–∏–∑–Ω—É—é –≤–µ—Ä—Å–∏—é
flutter build apk        # Android
flutter build ios        # iOS
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ API URL –≤ Flutter:**
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `apps/flutter/lib/core/constants/api_url.dart`:

```dart
class Apiurl {
  static const String api = 'http://localhost:8081';  // –∏–ª–∏ –≤–∞—à URL
  static const String ws = 'ws://localhost:8081';     // –∏–ª–∏ wss:// –¥–ª—è HTTPS
}
```

#### 6. –ó–∞–ø—É—Å–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
cd frontend

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev-—Å–µ—Ä–≤–µ—Ä
npm run dev

# –ò–ª–∏ —Å–æ–±–µ—Ä–∏—Ç–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
npm run build
npm run preview
```

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ `http://localhost:5173` (–∏–ª–∏ –¥—Ä—É–≥–æ–º –ø–æ—Ä—Ç—É, —É–∫–∞–∑–∞–Ω–Ω–æ–º Vite)

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ API URL:**
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `frontend/src/config/env.ts` –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:

```bash
# .env
VITE_API_URL=http://localhost:8081
VITE_WS_URL=ws://localhost:8081
```

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ:
```bash
VITE_API_URL=https://api.ren-messenger.com npm run build
```

---

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **Backend API**: –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API –≤ [`backend/specification.md`](backend/specification.md)
- **Frontend API**: –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ [`frontend/specification.md`](frontend/specification.md)
- **Ren-SDK**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è SDK –≤ [`Ren-SDK/README.md`](Ren-SDK/README.md)
- **Flutter App**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ [`apps/flutter/README.md`](apps/flutter/README.md)

### üîê –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

Ren –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—É—é –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—é —Å —Å–∏—Å—Ç–µ–º–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–æ–≤ (envelope encryption). –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —à–∏—Ñ—Ä—É–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º –∫–ª—é—á–æ–º, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Ç–µ–º –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è (wraps) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ.

#### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –ö–ª–∏–µ–Ω—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–∞—Ä—É –∫–ª—é—á–µ–π X25519 (`generate_key_pair()`)
2. –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (`pubk`) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á –∏–∑ –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ PBKDF2-HMAC-SHA256 (100k –∏—Ç–µ—Ä–∞—Ü–∏–π) —Å —Å–æ–ª—å—é
4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–ª—é—á –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (recovery key) - —Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
5. –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —à–∏—Ñ—Ä—É–µ—Ç—Å—è –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏:
   - `pkebymk` - –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–æ–º (–¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
   - `pkebyrk` - –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –∫–ª—é—á–æ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (–¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞)
6. –í—Å–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ–ª—å —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
7. –ü–∞—Ä–æ–ª—å —Ö–µ—à–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Argon2id –∏ —Ç–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

#### 2. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

1. –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ –≤—Å–µ—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–π —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –∫–ª—é—á –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è (`generate_nonce()`)
3. –°–æ–æ–±—â–µ–Ω–∏–µ —à–∏—Ñ—Ä—É–µ—Ç—Å—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º –∫–ª—é—á–æ–º (ChaCha20-Poly1305)
4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—è —Å–æ–∑–¥–∞—ë—Ç—Å—è –∫–æ–Ω–≤–µ—Ä—Ç:
   - –°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –∫–ª—é—á —à–∏—Ñ—Ä—É–µ—Ç—Å—è –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º –ø–æ–ª—É—á–∞—Ç–µ–ª—è (`wrap_symmetric_key()`)
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —ç—Ñ–µ–º–µ—Ä–Ω–∞—è –ø–∞—Ä–∞ –∫–ª—é—á–µ–π –¥–ª—è ECDH
   - –†–µ–∑—É–ª—å—Ç–∞—Ç —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω–≤–µ—Ä—Ç —Å nonce
5. –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∫–æ–Ω–≤–µ—Ä—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä

#### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è

1. –ü–æ–ª—É—á–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Å–≤–æ–π –∫–æ–Ω–≤–µ—Ä—Ç —á–µ—Ä–µ–∑ WebSocket –∏–ª–∏ REST API
2. –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–æ–º (–∏–∑ –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ PBKDF2)
3. –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –∫–ª—é—á –∏–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –∏ —ç—Ñ–µ–º–µ—Ä–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –∏–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞
   - –í—ã—á–∏—Å–ª—è–µ—Ç shared secret —á–µ—Ä–µ–∑ ECDH
   - –î–µ—Ä–∏–≤–∏—Ä—É–µ—Ç –∫–ª—é—á –æ–±—ë—Ä—Ç–∫–∏ —á–µ—Ä–µ–∑ HKDF-SHA256 —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º "ren-sdk-wrap"
   - –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –æ–±—ë—Ä–Ω—É—Ç—ã–π –∫–ª—é—á —á–µ—Ä–µ–∑ ChaCha20-Poly1305
4. –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º –∫–ª—é—á–æ–º (`decrypt_message()`)

#### 4. –§–∞–π–ª—ã

–§–∞–π–ª—ã —à–∏—Ñ—Ä—É—é—Ç—Å—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏—è–º:
- –§–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–±–∏—Ç –Ω–∞ —á–∞–Ω–∫–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ (>50MB –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
- –ö–∞–∂–¥—ã–π —á–∞–Ω–∫ —à–∏—Ñ—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º –∫–ª—é—á–æ–º —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º nonce
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞ (–∏–º—è, —Ç–∏–ø, —Ä–∞–∑–º–µ—Ä, –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ JSONB –ø–æ–ª–µ `metadata`
- –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω –≤ `metadata.enc_file` –∏–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ `/media/{id}`
- –§–∞–π–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ –¥–∏—Å–∫–µ –≤ `uploads/media/` —Å UUID –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∫–æ–ª–ª–∏–∑–∏–π –∏–º–µ–Ω

### üîÑ –ü–æ—Ç–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å ‚îÇ                    ‚îÇ   –°–µ—Ä–≤–µ—Ä    ‚îÇ                    ‚îÇ –ü–æ–ª—É—á–∞—Ç–µ–ª—å  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                                   ‚îÇ                                   ‚îÇ
       ‚îÇ‚îÄ‚îÄ 1. –ó–∞–ø—Ä–æ—Å PK –≤—Å–µ—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π ‚îÄ>‚îÇ                                   ‚îÇ
       ‚îÇ<‚îÄ‚îÄ 2. –ü—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                                   ‚îÇ
       ‚îÇ                                   ‚îÇ                                   ‚îÇ
       ‚îÇ‚îÄ‚îÄ 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è msg_key ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                                   ‚îÇ
       ‚îÇ‚îÄ‚îÄ 4. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                                   ‚îÇ
       ‚îÇ‚îÄ‚îÄ 5. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–æ–≤ –¥–ª—è ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                                   ‚îÇ
       ‚îÇ    –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—è             ‚îÇ                                   ‚îÇ
       ‚îÇ‚îÄ‚îÄ 6. WebSocket: send_message ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ                                   ‚îÇ
       ‚îÇ                                   ‚îÇ‚îÄ‚îÄ 7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ
       ‚îÇ                                   ‚îÇ‚îÄ‚îÄ 8. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å–∞      ‚îÇ
       ‚îÇ                                   ‚îÇ    –∏ in_chat —Å—Ç–∞—Ç—É—Å–∞              ‚îÇ
       ‚îÇ                                   ‚îÇ                                   ‚îÇ
       ‚îÇ                                   ‚îÇ‚îÄ‚îÄ 9a. –ï—Å–ª–∏ –≤ —á–∞—Ç–µ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ
       ‚îÇ                                   ‚îÇ    message_new —Å–æ–±—ã—Ç–∏–µ            ‚îÇ
       ‚îÇ                                   ‚îÇ                                   ‚îÇ
       ‚îÇ                                   ‚îÇ‚îÄ‚îÄ 9b. –ï—Å–ª–∏ –æ–Ω–ª–∞–π–Ω, –Ω–æ –Ω–µ –≤ —á–∞—Ç–µ ‚îÄ‚îÄ>‚îÇ
       ‚îÇ                                   ‚îÇ    notification_new —Å–æ–±—ã—Ç–∏–µ        ‚îÇ
       ‚îÇ                                   ‚îÇ                                   ‚îÇ
       ‚îÇ                                   ‚îÇ                                   ‚îÇ‚îÄ‚îÄ 10. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞
       ‚îÇ                                   ‚îÇ                                   ‚îÇ‚îÄ‚îÄ 11. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
       ‚îÇ                                   ‚îÇ                                   ‚îÇ‚îÄ‚îÄ 12. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ UI
```

### üì± –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

#### Flutter

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- **Clean Architecture** —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ —Å–ª–æ–∏:
  - `data/` - API –∫–ª–∏–µ–Ω—Ç—ã –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (—Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
  - `domain/` - –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
  - `presentation/` - UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **Provider** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º (DI —á–µ—Ä–µ–∑ `MultiProvider`)
- **FFI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** —Å Rust SDK —á–µ—Ä–µ–∑ `dart:ffi`
- **WebSocket –∫–ª–∏–µ–Ω—Ç** –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **–õ–æ–∫–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** —á–µ—Ä–µ–∑ `flutter_local_notifications`
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** —Ç–æ–∫–µ–Ω–æ–≤ –∏ –∫–ª—é—á–µ–π —á–µ—Ä–µ–∑ `flutter_secure_storage`

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SDK:**
- –ù–∞—Ç–∏–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `DynamicLibrary`:
  - **Android**: `libren_sdk.so` –∏–∑ `jniLibs/` (arm64-v8a, armeabi-v7a, x86, x86_64)
  - **iOS**: `RenSDK.xcframework` —á–µ—Ä–µ–∑ `DynamicLibrary.process()` (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ª–∏–Ω–∫–æ–≤–∫–∞)
  - **macOS**: –ø–æ–∏—Å–∫ `libren_sdk.dylib` –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ª–æ–∫–∞—Ü–∏—è—Ö (Frameworks, Resources)
  - **Linux**: `libren_sdk.so` –∏–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—É—Ç–µ–π
  - **Windows**: `ren_sdk.dll` –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ SDK –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ FFI –±–∏–Ω–¥–∏–Ω–≥–∏ –≤ `core/sdk/ren_sdk.dart`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é:
  - –°—Ç—Ä–æ–∫–∏ C –æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `ren_free_string()`
  - –ë–∞–π—Ç–æ–≤—ã–µ –º–∞—Å—Å–∏–≤—ã —á–µ—Ä–µ–∑ `ren_free_bytes()`
  - –°—Ç—Ä—É–∫—Ç—É—Ä—ã —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (`ren_free_key_pair`, `ren_free_encrypted_message` –∏ —Ç.–¥.)
- Singleton –ø–∞—Ç—Ç–µ—Ä–Ω: `RenSdk.instance` –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `flutter_secure_storage` (Keychain –Ω–∞ iOS, Keystore –Ω–∞ Android)
- –•—Ä–∞–Ω–∏–º—ã–µ –∫–ª—é—á–∏:
  - `token` - JWT —Ç–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  - `privateKey` - —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (base64)
  - `publicKey` - –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (base64)
  - `userId` - ID —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–º—ã –∏ —Ñ–æ–Ω–∞
- –ö–ª—é—á–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—â–∏—â—ë–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –û–°

**WebSocket –∫–ª–∏–µ–Ω—Ç:**
- –ö–ª–∞—Å—Å `RealtimeClient` —Å –º–µ—Ç–æ–¥–∞–º–∏:
  - `connect()` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å —Ç–æ–∫–µ–Ω–æ–º –∏–∑ secure storage
  - `disconnect()` - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏ –æ—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
  - `init(contacts)` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –Ω–∞ –∫–æ–Ω—Ç–∞–∫—Ç—ã
  - `joinChat(chatId)` / `leaveChat(chatId)` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –Ω–∞ —á–∞—Ç—ã
  - `sendMessage()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
  - `typing(chatId, isTyping)` - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
  - `editMessage()`, `deleteMessage()`, `forwardMessage()` - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- –°–æ–±—ã—Ç–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `Stream<RealtimeEvent>` —Å broadcast
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ JSON –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ –æ—à–∏–±–æ–∫

**–†–∞–±–æ—Ç–∞ —Å —á–∞—Ç–∞–º–∏:**
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:**
  - –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ –¥–∏—Å–∫–µ (`getTemporaryDirectory()/ren_ciphertext_cache/`)
  - In-memory –∫—ç—à –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ `_ciphertextInFlight`
- **–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π:**
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ —á–µ—Ä–µ–∑ `unwrapSymmetricKey()`
  - –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ `decryptMessage()`
  - –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –≤–ª–æ–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ `decryptFileBytes()`
- **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:**
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
  - –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
  - Self-check –≤–∞–ª–∏–¥–∞—Ü–∏—è: –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω–≤–µ—Ä—Ç
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –º–µ–¥–∏–∞-—Ñ–∞–π–ª–æ–≤
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–ª–æ–∂–µ–Ω–∏–π:**
  - –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ `/media`
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ `metadata` –ø–æ–ª–µ —Å–æ–æ–±—â–µ–Ω–∏—è
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `file_id` –¥–ª—è —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
- –õ–æ–∫–∞–ª—å–Ω—ã–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ `flutter_local_notifications`
- –ö–∞–Ω–∞–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: `ren_messages` —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–≤–∞—Ç–∞—Ä–æ–≤ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö (–∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π: –ø–µ—Ä–µ—Ö–æ–¥ –∫ —á–∞—Ç—É —á–µ—Ä–µ–∑ callback `setOnOpenChat()`
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–º—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ —á–∞—Ç–∞–º (—Å—Ç–∞–±–∏–ª—å–Ω—ã–π ID = chatId)

**–ö–ª—é—á –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:**
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 6-—Å–∏–º–≤–æ–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏–∑ –∞–ª—Ñ–∞–≤–∏—Ç–∞ `A-Z0-9`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Random.secure()` –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –ö–ª—é—á –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è `pkebyrk` (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á–æ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- **Glass morphism –¥–∏–∑–∞–π–Ω** - –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ —Å —Ä–∞–∑–º—ã—Ç–∏–µ–º
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≤–∏–¥–∂–µ—Ç—ã** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ —ç–∫—Ä–∞–Ω–æ–≤
- **–ê–Ω–∏–º–∞—Ü–∏–∏** - –ø–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
- **–ö–∞—Å—Ç–æ–º–Ω—ã–µ –≤–∏–¥–∂–µ—Ç—ã:**
  - `GlassSurface`, `GlassOverlay` - —Å—Ç–µ–∫–ª—è–Ω–Ω—ã–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
  - `MatteButton`, `MatteTextField` - —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤–≤–æ–¥–∞
  - `Avatar` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–≤–∞—Ç–∞—Ä–∞ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
  - `ContextMenu` - –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω—é –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
  - `AnimatedGradient` - –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –¥–ª—è —Ñ–æ–Ω–∞

**–ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:**
- –î–≤—É—Ö—à–∞–≥–æ–≤–∞—è —Ñ–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:
  1. –í–≤–æ–¥ –ª–æ–≥–∏–Ω–∞, –ø–∞—Ä–æ–ª—è –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è
  2. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (6 —Å–∏–º–≤–æ–ª–æ–≤)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–≤–æ–π –ø–∞—Ä—ã X25519 —á–µ—Ä–µ–∑ SDK
- –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–∞ –∏–∑ –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ PBKDF2
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏:
  - `pkebymk` - –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–æ–º (–¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
  - `pkebyrk` - –∫–ª—é—á–æ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (–¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–µ–≤—ã—Ö –ø–∞—Ä –ø—Ä–∏ –≤—Ö–æ–¥–µ (self-check —á–µ—Ä–µ–∑ wrap/unwrap)

**–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `multipart/form-data` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ `file_picker`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ `image_picker` (–≥–∞–ª–µ—Ä–µ—è –∏ –∫–∞–º–µ—Ä–∞)
- –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ `/media` endpoint
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤ (–∏–º—è, —Ç–∏–ø, —Ä–∞–∑–º–µ—Ä, nonce) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `metadata` —Å–æ–æ–±—â–µ–Ω–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `file_id` –¥–ª—è —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–≤–º–µ—Å—Ç–æ inline ciphertext)

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ö–∞—Å—Ç–æ–º–Ω—ã–π –∫–ª–∞—Å—Å `ApiException` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ API
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ DioException —Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- Graceful degradation –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ (–ø–æ–∫–∞–∑ "[encrypted]")
- –û—á–∏—Å—Ç–∫–∞ secure storage –ø—Ä–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∫–ª—é—á–µ–π

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `dio` - HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è REST API
- `web_socket_channel` - WebSocket –∫–ª–∏–µ–Ω—Ç
- `flutter_secure_storage` - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π
- `provider` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- `image_picker` - –≤—ã–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –≥–∞–ª–µ—Ä–µ–∏/–∫–∞–º–µ—Ä—ã
- `file_picker` - –≤—ã–±–æ—Ä —Ñ–∞–π–ª–æ–≤
- `flutter_local_notifications` - –ª–æ–∫–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `path_provider` - –¥–æ—Å—Ç—É–ø –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `mime` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ MIME —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
- `hugeicons` - –∏–∫–æ–Ω–∫–∏
- `logger` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- `ffi` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–∞—Ç–∏–≤–Ω—ã–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏:**
- `features/auth` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∫–ª—é—á–µ–π, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–µ–≤—ã—Ö –ø–∞—Ä
- `features/chats` - —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤, —á–∞—Ç-–∫–æ–º–Ω–∞—Ç–∞ —Å real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤
- `features/profile` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–º—ã –∏ —Ñ–æ–Ω–∞
- `features/splash` - —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `core/sdk` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Ren-SDK —á–µ—Ä–µ–∑ FFI
- `core/realtime` - WebSocket –∫–ª–∏–µ–Ω—Ç —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Å–æ–±—ã—Ç–∏–π
- `core/notifications` - –ª–æ–∫–∞–ª—å–Ω—ã–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `core/secure` - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ secure storage
- `core/cryptography` - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)
- `core/providers` - –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –¥–ª—è —Ç–µ–º—ã, —Ñ–æ–Ω–∞, –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- `shared/widgets` - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (glass surfaces, buttons, avatars)

#### React Web

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- React 19 —Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –∏ —Ö—É–∫–∞–º–∏
- React Router v7 –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- TanStack Query v5 –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- Context API –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (Auth, Realtime)
- WASM –º–æ–¥—É–ª—å Ren-SDK –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `init()`)
- Radix UI –¥–ª—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- Tailwind CSS v4 –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
- Framer Motion –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SDK:**
- WASM –º–æ–¥—É–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –í—Å–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**WebSocket:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∫–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è presence
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (connecting, connected, disconnected, error)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ React Context

**–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `/login` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- `/register` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∫–ª—é—á–µ–π
- `/` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º —á–∞—Ç–æ–≤
- `/chat/:chatId` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —á–∞—Ç–∞ —Å real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏

---

## üîß API –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

### üåê –ë–∞–∑–æ–≤—ã–π URL

```
http://localhost:8081
```

### üîë –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–∫—Ä–æ–º–µ `/auth/*` –∏ `/health`) —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:

```
Authorization: Bearer <jwt_token>
```

### üìù –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### üë§ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

```http
POST   /auth/register
Body: {
  "login": "string",
  "username": "string",
  "password": "string",
  "public_key": "string (base64)",
  "encrypted_private_key": "string (base64)",
  "salt": "string (base64)"
}
Response: {
  "user": UserResponse,
  "token": "string (JWT)"
}

POST   /auth/login
Body: {
  "login": "string",
  "password": "string"
}
Response: {
  "user": UserResponse,
  "token": "string (JWT)"
}
```

#### üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

```http
GET    /users/me
Response: UserResponse

PATCH  /users/username
Body: { "username": "string" }
Response: UserResponse

PATCH  /users/avatar
Body: MultipartFormData (file)
Response: UserResponse

GET    /users/search?q=string&limit=10
Response: UserResponse[]

GET    /users/{id}/public-key
Response: { "public_key": "string (base64)" }

GET    /avatars/*path
Response: File (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞)

DELETE /users/me
Response: 204 No Content
```

#### üí¨ –ß–∞—Ç—ã

```http
POST   /chats
Body: {
  "kind": "private" | "group",
  "user_ids": number[],
  "title": "string" (–¥–ª—è –≥—Ä—É–ø–ø)
}
Response: Chat

GET    /chats
Query: ?limit=20&offset=0
Response: Chat[]

GET    /chats/{chat_id}/messages
Query: ?limit=50&before_id=123&after_id=456
Response: Message[]

POST   /chats/{id}/favorite
Response: 200 OK

DELETE /chats/{id}/favorite
Response: 200 OK

DELETE /chats/{id}
Response: 204 No Content
```

#### üìé –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã

```http
POST   /media
Body: MultipartFormData (file, max 50MB)
Response: {
  "file_id": number,
  "filename": "string",
  "mimetype": "string",
  "size": number
}

GET    /media/{id}
Response: File (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª)
```

#### üåê WebSocket

**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**
```
GET /ws
Headers: Authorization: Bearer <jwt_token>
```

**–°–æ–±—ã—Ç–∏—è –∫–ª–∏–µ–Ω—Ç–∞ ‚Üí —Å–µ—Ä–≤–µ—Ä:**

```json
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–æ–Ω—Ç–∞–∫—Ç—ã)
{
  "type": "init",
  "contacts": [1, 2, 3]
}

// –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ —á–∞—Ç—É
{
  "type": "join_chat",
  "chat_id": 123
}

// –í—ã—Ö–æ–¥ –∏–∑ —á–∞—Ç–∞
{
  "type": "leave_chat",
  "chat_id": 123
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
{
  "type": "send_message",
  "chat_id": 123,
  "message": "base64_encrypted_message",
  "message_type": "text" | "file" | "image",
  "envelopes": {
    "2": {
      "key": "base64_wrapped_key",
      "ephem_pub_key": "base64_ephemeral_key",
      "iv": "base64_iv"
    }
  },
  "metadata": [FileMetadata],
  "reply_to_message_id": 456
}

// –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
{
  "type": "edit_message",
  "chat_id": 123,
  "message_id": 789,
  "message": "base64_encrypted_message",
  "envelopes": {...}
}

// –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
{
  "type": "delete_message",
  "chat_id": 123,
  "message_id": 789
}

// –ü–µ—Ä–µ—Å—ã–ª–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
{
  "type": "forward_message",
  "from_chat_id": 123,
  "message_id": 789,
  "to_chat_id": 456,
  "message": "base64_encrypted_message",
  "envelopes": {...}
}

// –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
{
  "type": "typing",
  "chat_id": 123,
  "is_typing": true
}
```

**–°–æ–±—ã—Ç–∏—è —Å–µ—Ä–≤–µ—Ä ‚Üí –∫–ª–∏–µ–Ω—Ç:**

```json
// –£—Å–ø–µ—à–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
{ "type": "ok" }

// –û—à–∏–±–∫–∞
{ "type": "error", "error": "error message" }

// –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
{
  "type": "message_new",
  "chat_id": 123,
  "message": Message
}

// –û–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
{
  "type": "message_updated",
  "chat_id": 123,
  "message": Message
}

// –£–¥–∞–ª—ë–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
{
  "type": "message_deleted",
  "chat_id": 123,
  "message_id": 789,
  "deleted_at": "2024-01-01T00:00:00Z",
  "deleted_by": 1
}

// –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
{
  "type": "typing",
  "chat_id": 123,
  "user_id": 2,
  "is_typing": true
}

// –û–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å
{
  "type": "presence",
  "user_id": 2,
  "status": "online" | "offline"
}

// –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
{
  "type": "notification_new",
  "chat_id": 123,
  "message": Message
}
```

### üìä –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### UserResponse (–ø—É–±–ª–∏—á–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å)
```typescript
{
  id: number
  login: string
  username: string
  avatar: string | null  // –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∞–≤–∞—Ç–∞—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "avatars/user_123.jpg")
}
```

#### UserAuthResponse (–ø—Ä–∏ –≤—Ö–æ–¥–µ/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏)
```typescript
{
  id: number
  login: string
  username: string
  avatar: string | null
  pkebymk: string  // –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (–º–∞—Å—Ç–µ—Ä-–∫–ª—é—á)
  pkebyrk: string  // –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (–∫–ª—é—á –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)
  salt: string     // —Å–æ–ª—å –¥–ª—è PBKDF2 (base64)
  pubk: string     // –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (base64)
}
```

#### Chat
```typescript
{
  id: number
  kind: "private" | "group"
  title: string | null  // —Ç–æ–ª—å–∫–æ –¥–ª—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤
  created_at: string  // ISO8601
  updated_at: string  // ISO8601
  is_archived: boolean | null
  is_favorite?: boolean  // –∏–∑–±—Ä–∞–Ω–Ω—ã–π —á–∞—Ç
  peer_id?: number  // ID —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ (–¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —á–∞—Ç–æ–≤)
  peer_username?: string  // –∏–º—è —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞
  peer_avatar?: string | null  // –∞–≤–∞—Ç–∞—Ä —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞
}
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —á–∞—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∞—è –ø–∞—Ä–∞ `user_a` –∏ `user_b` (–≥–¥–µ `user_a < user_b`) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —á–∞—Ç–æ–≤ –º–µ–∂–¥—É –æ–¥–Ω–∏–º–∏ –∏ —Ç–µ–º–∏ –∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.

#### Message
```typescript
{
  id: number
  chat_id: number
  sender_id: number
  message: string  // –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (base64)
  message_type: "text" | "file" | "image"
  created_at: string  // ISO8601
  edited_at: string | null  // ISO8601
  is_read: boolean
  has_files?: boolean
  metadata?: FileMetadata[]
  envelopes?: { [userId: string]: Envelope }
  reply_to_message_id?: number
  forwarded_from_message_id?: number
  forwarded_from_chat_id?: number
  forwarded_from_sender_id?: number
  status?: "pending" | "sent"  // –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
}
```

#### Envelope (–∫–æ–Ω–≤–µ—Ä—Ç –¥–ª—è E2EE)
```typescript
{
  key: string  // –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á (base64)
  ephem_pub_key: string  // —ç—Ñ–µ–º–µ—Ä–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (base64)
  iv: string  // –≤–µ–∫—Ç–æ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (base64)
}
```

#### FileMetadata
```typescript
{
  file_id?: number  // ID —Ñ–∞–π–ª–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ media_files
  filename: string  // –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
  mimetype: string  // MIME —Ç–∏–ø (–Ω–∞–ø—Ä–∏–º–µ—Ä, "image/jpeg", "application/pdf")
  size: number  // —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –±–∞–π—Ç–∞—Ö
  enc_file?: string | null  // –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª (base64) - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∑–∞–ø–∏—Å–∏
  nonce?: string | null  // nonce –¥–ª—è —Ñ–∞–π–ª–∞ (base64)
  file_creation_date?: string | null  // –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞ (ISO8601)
  // –î–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤, —Ä–∞–∑–±–∏—Ç—ã—Ö –Ω–∞ —á–∞–Ω–∫–∏:
  nonces?: string[]  // –º–∞—Å—Å–∏–≤ nonce –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞–Ω–∫–∞
  chunk_size?: number  // —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ –≤ –±–∞–π—Ç–∞—Ö
  chunk_count?: number  // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞–Ω–∫–æ–≤
}
```

**–•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:**
- –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `uploads/media/` —Å –∏–º–µ–Ω–µ–º `{user_id}_{uuid}`
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `media_files` —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ —á–∞—Ç –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –î–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è: –≤–ª–∞–¥–µ–ª–µ—Ü –∏–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫ —á–∞—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ETag –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### üîí –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã

- **–ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è**: X25519 Elliptic Curve Diffie-Hellman (ECDH)
- **–°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ**: ChaCha20-Poly1305 AEAD
- **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π**: Argon2id
- **–î–µ—Ä–∏–≤–∞—Ü–∏—è –∫–ª—é—á–µ–π**: PBKDF2-HMAC-SHA256 (100,000 –∏—Ç–µ—Ä–∞—Ü–∏–π)
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª**: `getrandom()` —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º
- **–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω–≤–µ—Ä—Ç–æ–≤**: PKI-like –ø–æ–¥—Ö–æ–¥ –¥–ª—è –º—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —á–∞—Ç–æ–≤

### üõ°Ô∏è –ú–µ—Ä—ã –∑–∞—â–∏—Ç—ã

- ‚úÖ **–ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** - —Ç–æ–ª—å–∫–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –∫–æ–Ω–≤–µ—Ä—Ç—ã —á–µ—Ä–µ–∑ —Å–≤–æ–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
- ‚úÖ **–î–≤–æ–π–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π**:
  - –ú–∞—Å—Ç–µ—Ä-–∫–ª—é—á –∏–∑ –ø–∞—Ä–æ–ª—è (–¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
  - –ö–ª—é—á –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (–¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ –ø–∞—Ä–æ–ª—è)
- ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç MITM** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –æ–±–º–µ–Ω–µ
- ‚úÖ **–ú–∞—Å—Ç–µ—Ä-–∫–ª—é—á –∏–∑ –ø–∞—Ä–æ–ª—è** - PBKDF2-HMAC-SHA256 —Å 100k –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏ –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–π —Å–æ–ª—å—é
- ‚úÖ **–≠—Ñ–µ–º–µ—Ä–Ω—ã–µ –∫–ª—é—á–∏** - –∫–∞–∂–¥—ã–π –∫–æ–Ω–≤–µ—Ä—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é —ç—Ñ–µ–º–µ—Ä–Ω—É—é –ø–∞—Ä—É –∫–ª—é—á–µ–π –¥–ª—è ECDH
- ‚úÖ **HKDF –¥–ª—è –¥–µ—Ä–∏–≤–∞—Ü–∏–∏** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HKDF-SHA256 –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –¥–µ—Ä–∏–≤–∞—Ü–∏–∏ –∫–ª—é—á–µ–π –∏–∑ shared secret
- ‚úÖ **Zero-Knowledge** - —Å–µ—Ä–≤–µ—Ä –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏—è–º, —Ç–æ–ª—å–∫–æ –∫ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º
- ‚úÖ **–û—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç—ã** - –∫–∞–∂–¥—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–π –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á, –¥–∞–∂–µ –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö
- ‚úÖ **JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –±–µ–∑ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ **CORS –∑–∞—â–∏—Ç–∞** - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ CORS —á–µ—Ä–µ–∑ `CorsLayer`
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞** - middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–ª–µ–Ω—Å—Ç–≤–∞ –≤ —á–∞—Ç–∞—Ö –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤** - middleware –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç –ø–∞—Ä–æ–ª–∏ –∏ —Ç–æ–∫–µ–Ω—ã –≤ –ª–æ–≥–∞—Ö

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- –°–µ—Ä–≤–µ—Ä —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∫–æ–Ω–≤–µ—Ä—Ç—ã - –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–∏–¥–∏—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ –¥–≤–æ–π–Ω–æ–º –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ:
  - `pkebymk` - –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–æ–º (–∏–∑ –ø–∞—Ä–æ–ª—è)
  - `pkebyrk` - –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –∫–ª—é—á–æ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (–¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞)
- –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –∫–ª—é—á (32 –±–∞–π—Ç–∞, —Å–ª—É—á–∞–π–Ω—ã–π)
- –ö–∞–∂–¥—ã–π –∫–æ–Ω–≤–µ—Ä—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é —ç—Ñ–µ–º–µ—Ä–Ω—É—é –ø–∞—Ä—É –∫–ª—é—á–µ–π –¥–ª—è ECDH
- –ö–æ–Ω–≤–µ—Ä—Ç—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
- –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–π –±–µ–∑ –∑–Ω–∞–Ω–∏—è –ø–∞—Ä–æ–ª—è –∏–ª–∏ –∫–ª—é—á–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- **–í–∞–∂–Ω–æ**: –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
  - –°–∏–ª—å–Ω—ã–π `JWT_SECRET` (–º–∏–Ω–∏–º—É–º 32 —Å–ª—É—á–∞–π–Ω—ã—Ö –±–∞–π—Ç–∞)
  - HTTPS –¥–ª—è –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
  - –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (–Ω–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!)
  - –†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### üîê –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–ü–∞—Ä–æ–ª–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ (–º–∏–Ω–∏–º—É–º 12 —Å–∏–º–≤–æ–ª–æ–≤, —Å–º–µ—à–∞–Ω–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä, —Ü–∏—Ñ—Ä—ã, —Å–∏–º–≤–æ–ª—ã)
2. **HTTPS**: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –¥–ª—è –∑–∞—â–∏—Ç—ã —Ç—Ä–∞—Ñ–∏–∫–∞
3. **JWT_SECRET**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π —Å–ª—É—á–∞–π–Ω—ã–π –∫–ª—é—á (–º–∏–Ω–∏–º—É–º 32 –±–∞–π—Ç–∞)
   ```bash
   # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–∞
   openssl rand -base64 32
   ```
4. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ë–î —Ç–æ–ª—å–∫–æ –¥–ª—è –±—ç–∫–µ–Ω–¥–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSL —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
5. **–§–∞–π–ª—ã**: –•—Ä–∞–Ω–∏—Ç–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º
6. **–ö–ª—é—á –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è**: –•—Ä–∞–Ω–∏—Ç–µ `pkebyrk` –∏ –∫–ª—é—á –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
7. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: Middleware –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç –ø–∞—Ä–æ–ª–∏ –∏ —Ç–æ–∫–µ–Ω—ã –≤ –ª–æ–≥–∞—Ö
8. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞**: –§–∞–π–ª—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã 50MB –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è DoS –∞—Ç–∞–∫
9. **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –í—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
10. **WebSocket**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ WSS (WebSocket Secure) –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### ü¶Ä Rust SDK —Ç–µ—Å—Ç—ã

```bash
cd Ren-SDK
cargo test

# –° WASM —Ç–µ—Å—Ç–∞–º–∏
wasm-pack test --node

# –° FFI —Ç–µ—Å—Ç–∞–º–∏
cargo test --features ffi
```

### üöÄ –ë—ç–∫–µ–Ω–¥ —Ç–µ—Å—Ç—ã

```bash
cd backend
cargo test

# –° –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ë–î (—Ç—Ä–µ–±—É–µ—Ç DATABASE_URL)
DATABASE_URL=postgres://... cargo test
```

### üì± Flutter —Ç–µ—Å—Ç—ã

```bash
cd apps/flutter
flutter test

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
flutter test integration_test/
```

### üåê –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Ç–µ—Å—Ç—ã

```bash
cd frontend
npm run test

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
npm run test:coverage
```

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü

- **users** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
  - `id`, `login` (UNIQUE), `username` (UNIQUE), `avatar`
  - `password` (Argon2id hash)
  - `pkebymk`, `pkebyrk`, `pubk`, `salt` (E2EE –∫–ª—é—á–∏)
  
- **chats** - —á–∞—Ç—ã
  - `id`, `kind` ('private' | 'group'), `title`, `created_at`, `updated_at`
  - `is_archived`, `user_a`, `user_b` (–∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∞—è –ø–∞—Ä–∞ –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —á–∞—Ç–æ–≤)
  
- **chat_participants** - —É—á–∞—Å—Ç–Ω–∏–∫–∏ —á–∞—Ç–æ–≤
  - `chat_id`, `user_id` (PRIMARY KEY)
  - `joined_at`, `role` ('member' | 'admin'), `last_read_message_id`, `is_muted`
  
- **messages** - —Å–æ–æ–±—â–µ–Ω–∏—è
  - `id`, `chat_id`, `sender_id`, `message` (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ)
  - `message_type` ('text' | 'file' | 'image'), `created_at`, `edited_at`
  - `envelopes` (JSONB - –∫–æ–Ω–≤–µ—Ä—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞)
  - `metadata` (JSONB - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤)
  - `reply_to_message_id`, `forwarded_from_*` (–¥–ª—è reply/forward)
  - `deleted_at`, `deleted_by`, `is_read`
  
- **media_files** - –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã
  - `id`, `owner_id`, `chat_id`, `message_id`
  - `path` (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –≤ uploads/), `filename`, `mimetype`, `size`, `created_at`
  
- **chat_favorites** - –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —á–∞—Ç—ã
  - `user_id`, `chat_id` (PRIMARY KEY), `created_at`

### –ú–∏–≥—Ä–∞—Ü–∏–∏

–ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±—ç–∫–µ–Ω–¥–∞ —á–µ—Ä–µ–∑ SQLx:

```bash
cd backend
cargo run  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–∑ ./migrations
```

–†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π:

```bash
cd backend
sqlx migrate run
```

---

## üö¢ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–°–æ–∑–¥–∞–π—Ç–µ `docker-compose.yml` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```yaml
version: '3.8'

services:
  postgres:
    image: postgres:14-alpine
    environment:
      POSTGRES_DB: ren_messenger
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-password}
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 10s
      timeout: 5s
      retries: 5

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    environment:
      DATABASE_URL: postgres://postgres:${POSTGRES_PASSWORD:-password}@postgres:5432/ren_messenger
      JWT_SECRET: ${JWT_SECRET:-change-this-in-production}
    ports:
      - "8081:8081"
    depends_on:
      postgres:
        condition: service_healthy
    volumes:
      - ./uploads:/app/uploads  # –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

volumes:
  postgres_data:
```

**–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª –¥–ª—è Docker:**

```bash
POSTGRES_PASSWORD=your-secure-password
JWT_SECRET=your-super-secret-jwt-key-min-32-bytes
```

**–ó–∞–ø—É—Å–∫:**

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f backend

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
docker-compose down -v
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Å–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π `Dockerfile` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `backend/` —Å multi-stage build –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–±—Ä–∞–∑–∞.

### –ü—Ä–æ–¥–∞–∫—à–µ–Ω

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
   ```bash
   export DATABASE_URL=postgres://...
   export JWT_SECRET=strong-random-secret
   ```

2. **–°–æ–±–µ—Ä–∏—Ç–µ –±—ç–∫–µ–Ω–¥**:
   ```bash
   cd backend
   cargo build --release
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä**:
   ```bash
   ./target/release/backend
   ```

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ reverse proxy** (nginx):
   ```nginx
   server {
       listen 80;
       server_name api.ren-messenger.com;

       location / {
           proxy_pass http://localhost:8081;
           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection "upgrade";
       }
   }
   ```

---

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ú—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º –≤–∫–ª–∞–¥ –æ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞! –í–æ—Ç –∫–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–º–æ—á—å:

### üêõ –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [GitHub Issues](https://github.com/taiidzy/ren/issues)
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- –î–æ–±–∞–≤—å—Ç–µ —à–∞–≥–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
- –£–∫–∞–∂–∏—Ç–µ –≤–µ—Ä—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –ü–û

### üí° –§–∏—á-—Ä–µ–∫–≤–µ—Å—Ç—ã

- –û–ø–∏—à–∏—Ç–µ –∏–¥–µ—é –ø–æ–¥—Ä–æ–±–Ω–æ
- –û–±—ä—è—Å–Ω–∏—Ç–µ –ø–æ–ª—å–∑—É –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
- –°–æ–∑–¥–∞–π—Ç–µ issue —Å –º–µ—Ç–∫–æ–π `enhancement`

### üîß Pull Requests

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –≤–∞—à–µ–π —Ñ–∏—á–∏ (`git checkout -b feature/amazing-feature`)
3. –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
5. –°–ª–µ–¥—É–π—Ç–µ –∫–æ–¥-—Å—Ç–∞–π–ª—É –ø—Ä–æ–µ–∫—Ç–∞
6. –û—Ç–ø—Ä–∞–≤—å—Ç–µ PR —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π

### üìã –ö–æ–¥ —Å—Ç–∞–π–ª

- **Rust**: `cargo fmt` + `cargo clippy`
- **Flutter**: `dart format` + `flutter analyze`
- **TypeScript**: ESLint + Prettier (`npm run lint`)

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ **Apache License 2.0**. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE).

**–í–∞–∂–Ω–æ:** –†–∞–∑–ª–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ –ª–∏—Ü–µ–Ω–∑–∏–∏:
- **Ren-SDK**: MIT License (—Å–º. `Ren-SDK/LICENSE`)
- **–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç**: Apache License 2.0

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **–ê–≤—Ç–æ—Ä**: Taiidzy
- **Email**: taiidzy@yandex.ru
- **GitHub**: [@taiidzy](https://github.com/taiidzy)

---

## üó∫Ô∏è Roadmap

- [ ] –ì–æ–ª–æ—Å–æ–≤—ã–µ –∏ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏
- [ ] –ì—Ä—É–ø–ø–æ–≤—ã–µ –∑–≤–æ–Ω–∫–∏
- [ ] –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π
- [ ] Forward secrecy (–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è —Ü–µ–ª—å)
- [ ] Post-quantum –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
- [ ] –î–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [ ] –ë–æ—Ç—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- [ ] –°—Ç–∏–∫–µ—Ä—ã –∏ —ç–º–æ–¥–∑–∏
- [ ] –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- [ ] –°—Ç–∞—Ç—É—Å—ã –∏ –∏—Å—Ç–æ—Ä–∏–∏

---

<div align="center">

**‚≠ê –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –≤–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É!**

Made with ‚ù§Ô∏è and Rust

</div>
